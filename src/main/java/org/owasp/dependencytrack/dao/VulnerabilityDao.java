package org.owasp.dependencytrack.dao;

import org.owasp.dependencytrack.model.*;
import org.springframework.context.ApplicationEventPublisherAware;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;

/**
 * Created by Jason Wraxall on 1/12/15.
 */
public interface VulnerabilityDao extends ApplicationEventPublisherAware {
	@SuppressWarnings("unchecked")
	List<VulnerableComponent> getVulnerableComponents(
			ApplicationVersion applicationVersion);

	List<VulnerabilitySummary> getVulnerabilitySummary(int id);

	VulnerabilitySummary getVulnerabilitySummary(
			ApplicationVersion applicationVersion);

	List<Vulnerability> getVulnsForLibraryVersion(
			LibraryVersion libraryVersion);

	VulnerabilityTrend getVulnerabilityTrend(
			VulnerabilityTrend.Timespan timespan, int appVersionId);

	void initiateFullDependencyCheckScan();

	@Transactional(rollbackFor = Exception.class)
	void updateApplicationVersionVulnerabilityCount();

	@Transactional(rollbackFor = Exception.class)
	void updateLibraryVersionVulnerabilityCount();
}
