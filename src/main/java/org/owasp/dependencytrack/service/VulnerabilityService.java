package org.owasp.dependencytrack.service;

import org.owasp.dependencytrack.model.*;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;

/**
 * Created by Jason Wraxall on 1/12/15.
 */
public interface VulnerabilityService {
    @Transactional
    List<VulnerableComponent> getVulnerableComponents(ApplicationVersion applicationVersion);

    @Transactional
    List<VulnerabilitySummary> getVulnerabilitySummary(int id);

    @Transactional
    VulnerabilitySummary getVulnerabilitySummary(ApplicationVersion applicationVersion);

    @Transactional
    List<Vulnerability> getVulnsForLibraryVersion(LibraryVersion libraryVersion);

    @Transactional
    VulnerabilityTrend getVulnerabilityTrend(VulnerabilityTrend.Timespan timespan, int appVersionId);

    @Transactional
    void initiateFullDependencyCheckScan();

    @Transactional(rollbackFor = Exception.class)
    void updateApplicationVersionVulnerabilityCount();

    @Transactional(rollbackFor = Exception.class)
    void updateLibraryVersionVulnerabilityCount();
}
